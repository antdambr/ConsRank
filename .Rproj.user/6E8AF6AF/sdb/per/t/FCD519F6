{
    "collab_server" : "",
    "contents" : "#' Plot rankings on a permutation polytope of 3 o 4 objects containing all possible ties\n#'\n#' Plot rankings a permutation polytope that is the geometrical space of preference rankings. The plot is available for 3 or for 4 objects\n#'\n#' @param X the sample of rankings. Most of the time it is returned by tabulaterows\n#' @param L labels of the objects\n#' @param Wk frequency associated to each ranking\n#' @param nobj number of objects. It must be either 3 or 4\n#'\n#' @return the permutation polytope\n#' \n#' @details polyplot() plots the universe of 3 objecys. polyplot(nobj=4) plots the universe of 4 objecys. \n#'\n#' @references Thompson, G. L. (1993). Generalized permutation polytopes and exploratory graphical methods for ranked data. The Annals of Statistics, 1401-1430.\n#' #\n#' Heiser, W. J., and D'Ambrosio, A. (2013). Clustering and prediction of rankings within a Kemeny distance framework. In Algorithms from and for Nature and Life (pp. 19-31). Springer International Publishing.\n#'\n#' @author Antonio D'Ambrosio \\email{antdambr@unina.it} and Sonia Amodio \\email{sonia.amodio@unina.it}\n#' \n#' @seealso \\code{\\link{tabulaterows}} frequency distribution for ranking data.\n#' \n#' @examples \n#' polyplot()\n#' #polyplot(nobj=4)\n#' data(BU)\n#' polyplot(BU[,1:3],Wk=BU[,4])\n#' \n#' @keywords Permutation polytope\n#' \n#' @export\n#' \n#' @import rgl\n#' @importFrom graphics lines plot points text\n\npolyplot = function(X=NULL,L=NULL,Wk=NULL,nobj=3){\n  \n  \n  if (nobj==3){\n    \n    #rankings in the polytope\n    ranks=rbind(\n      c(1,2,3),\n      c(1,2,2),\n      c(1,3,2),\n      c(1,2,1),\n      c(2,3,1),\n      c(2,2,1),\n      c(3,2,1),\n      c(2,1,1),\n      c(3,1,2),\n      c(2,1,2),\n      c(2,1,3),\n      c(1,1,2),\n      c(1,1,1)\n    )\n    \n    if (is.null(L)){\n      rr=labels(ranks,3,labs=2)\n    } else {\n      rr=labels(ranks,3,L,labs=1)\n    }\n    \n    #coordinates of polytope\n    coord=rbind(\n      c(  0.000000e+00,  4.082483e-01), #ABC\n      c(  1.767767e-01,  3.061862e-01), #A(BC)\n      c(  3.535534e-01,  2.041241e-01), #ACB\n      c(  3.535534e-01,  1.817407e-16), #(AC)B\n      c(  3.535534e-01, -2.041241e-01), #CAB\n      c(  1.767767e-01, -3.061862e-01), #C(AB)\n      c(  5.192593e-17, -4.082483e-01), #CBA\n      c( -1.767767e-01, -3.061862e-01), #(BC)A\n      c( -3.535534e-01, -2.041241e-01), #BCA\n      c( -3.535534e-01, -1.038519e-16), #B(AC)\n      c( -3.535534e-01,  2.041241e-01), #BAC\n      c( -1.767767e-01,  3.061862e-01), #(AB)C\n      c(  5.517130e-17,  4.543519e-17)  #(ABC)\n    )\n    \n    \n    plot(coord,ylim=c(-0.5,0.5),xlim=c(-0.5,0.5),axes=FALSE,ann=FALSE)\n    lines(coord[1:11,])\n    lines(c(coord[11,1],coord[1,1]),c(coord[11,2],coord[1,2]))\n    lines(c(coord[2,1],coord[8,1]),c(coord[2,2],coord[8,2]),lty=2)\n    lines(c(coord[4,1],coord[10,1]),c(coord[4,2],coord[10,2]),lty=2)\n    lines(c(coord[6,1],coord[12,1]),c(coord[6,2],coord[12,2]),lty=2)\n    \n    t1=c(1,2,3,11,12,13)\n    t2=c(4,10)\n    t3=c(5,6,7,8,9)\n    tcoord=coord #text coordinates\n    tcoord[t1,2]=tcoord[t1,2]+0.1\n    tcoord[t3,2]=tcoord[t3,2]-0.1\n    tcoord[t2[1],1]=tcoord[t2[1],1]+0.1\n    tcoord[t2[2],1]=tcoord[t2[2],1]-0.1\n    #text(tcoord,rr)\n    \n    if (is.null(X)){\n      indplot=matrix(1:13,ncol=1)\n    } else {\n      \n      #o = outer(seq_len(nrow(X)), seq_len(nrow(ranks)), Vectorize(\n      #  function(i, j) all(X2[i,]==ranks[j,])\n      #))\n      #ranksinplot=ranks[apply(o, 2, any),]\n      \n      o2 = outer(seq_len(nrow(ranks)), seq_len(nrow(X)), Vectorize(\n        function(i, j) which(all(ranks[i,]==X[j,]))\n      ))\n      \n      indexing=o2==1\n      #print(indexing)\n      indexing[indexing==TRUE]=1\n      indexing[is.na(indexing)]=0\n      indplot=which(rowSums(indexing)==1)\n      #print(indplot)\n    }\n    \n    # if (is.null(X)){\n    #   X=ranks\n    # }\n    #X\n    #put labels to rankings\n    if (is.null(Wk)){\n      \n      points(coord[indplot,1],coord[indplot,2],pch=16,cex=0.8,col=\"blue\")\n      \n    }else{\n      \n      if (is.numeric(Wk)) {\n        \n        Wk=matrix(Wk,ncol=1)\n        \n      }\n      \n      idwk=matrix(0,nrow(X),1)\n      counter=0\n      for (i in 1:13){\n        for (j in 1:nrow(X)){\n          check=sum(pos=X[j,]==ranks[i,])\n          if (check==3){\n            counter=counter+1\n            idwk[counter]=j\n            break}\n        }\n      }\n      \n      \n      \n      \n      points(coord[indplot,1],coord[indplot,2],pch=16,cex=sqrt(100*((Wk[idwk]/sum(Wk))/pi)/2),col=\"blue\")\n      \n    }\n    \n    \n    text(tcoord[indplot,],rr[indplot,])\n    \n  }else{ ##4 objects\n    \n    \n    #---------------------------------------------\n    \n    #-Exagon A first\n    E1=rbind(\n      c(0.5,  0.5,  1.4142135),  #   ...    %%'A B C D'     [1 2 3 4]   1\n      c(1.0,  1.0,  0.70710677), #  ...    %%'A C B D'     [1 3 2 4]   2\n      c(1.5,  0.5,  0.0), #                 %%'A C D B'     [1 4 2 3]   3\n      c(1.5, -0.5,  0.0), #         ...    %%'A D C B'     [1 4 3 2]   4\n      c(1.0, -1.0,  0.70710677), #  ...    %%'A D B C'     [1 3 4 2]   5\n      c(0.5, -0.5,  1.4142135) #   ...    %%'A B D C'     [1 2 4 3]   6\n    )\n    \n    \n    MA=apply(E1,2,mean) #  center of exagon A   A(BCD)  [1 2 2 2]  7\n    E1T=rbind(\n      c(1.2500,    0.7500,    0.3536),#;...  %% 'A C {BD}'   [1 3 2 3]   8\n      c(0.7500,   -0.7500,    1.0607),#;...  %% 'A {BD} C'   [1 2 3 2]   9\n      c(0.5000,         0,    1.4142),#;...  %% 'A B {CD}'   [1 2 3 3]   10\n      c(1.5000,         0,         0),#;...  %% 'A {CD} B'   [1 3 2 2]   11\n      c(1.2500,   -0.7500,    0.3536),#;...  %% 'A D {BC}'   [1 3 3 2]   12\n      c(0.7500,    0.7500,    1.0607)# ;...  %% 'A {BC} D'   [1 2 2 3]   13\n    )\n    \n    \n    \n    ranksA=rbind(\n      c(1,2,3,4),c(1,3,2,4),c(1,4,2,3),c(1,4,3,2),c(1,3,4,2),c(1,2,4,3),c(1,2,2,2),\n      c(1,3,2,3),c(1,2,3,2),c(1,2,3,3),c(1,3,2,2),c(1,3,3,2),c(1,2,2,3)\n    )\n    \n    #---------------------------------------------\n    #-Exagon B first\n    E2=rbind(\n      c(-1.5, -0.5,  0.0),#        ...    %%'B D C A'     [4 1 3 2]   14\n      c(-1.5,  0.5,  0.0),#        ...    %%'B C D A'     [4 1 2 3]   15 \n      c(-1.0,  1.0,  0.70710677),# ...    %%'B C A D'     [3 1 2 4]   16 \n      c(-0.5,  0.5,  1.4142135),#  ...    %%'B A C D'     [2 1 3 4]   17\n      c(-0.5, -0.5,  1.4142135),#  ...    %%'B A D C'     [2 1 4 3]   18\n      c(-1.0, -1.0,  0.70710677)# ...    %%'B D A C'     [3 1 4 2]   19\n    )\n    \n    MB=apply(E2,2,mean) #center of exagon B  B(ACD)        [2 1 2 2]  20\n    \n    E2T=rbind(\n      c(-0.5000,         0,    1.4142),#; ... %% 'B A {CD}'   [2 1 3 3]   21\n      c(-1.5000,         0,         0),#;...  %% 'B {CD} A'   [3 1 2 2]   22\n      c(-1.2500,    0.7500,    0.3536),#;...  %% 'B C {AD}'   [3 1 2 3]   23\n      c(-0.7500,   -0.7500,    1.0607),#;...  %% 'B {AD} C'   [2 1 3 2]   24\n      c(-1.2500,   -0.7500,    0.3536),#;...  %% 'B D {AC}'   [3 1 3 2]   25\n      c(-0.7500,    0.7500,    1.0607)# ;...  %% 'B {AC} D'   [2 1 2 3]   26\n    )\n    \n    \n    ranksB=rbind(\n      c(4,1,3,2),c(4,1,2,3),c(3,1,2,4),c(2,1,3,4),c(2,1,4,3),c(3,1,4,2),c(2,1,2,2),\n      c(2,1,3,3),c(3,1,2,2),c(3,1,2,3),c(2,1,3,2),c(3,1,3,2),c(2,1,2,3)\n    )\n    \n    \n    \n    #-------------------------------------------------\n    #exagon C first\n    \n    E3=rbind(\n      c(-1.0,  1.0, -0.70710677),# ...    %%'C B D A'     [4 2 1 3]   27\n      c(-0.5,  0.5, -1.4142135),#  ...    %%'C D B A'     [4 3 1 2]   28\n      c(0.5,  0.5, -1.4142135),#   ...    %%'C D A B'     [3 4 1 2]   29\n      c(1.0,  1.0, -0.70710677),#  ...    %%'C A D B'     [2 4 1 3]   30\n      c(0.5,  1.5,  0.0),#         ...    %%'C A B D'     [2 3 1 4]   31\n      c(-0.5,  1.5,  0.0) #        ...    %%'C B A D'     [3 2 1 4]   32\n    )\n    \n    MC=apply(E3,2,mean) #center of exagon C  C(ABD)        [2 2 1 2] 33\n    \n    E3T=rbind(\n      c(0,    0.5000,   -1.4142),      #;...  %% 'C D {AB}'   [3 3 1 2]   34\n      c(0,    1.5000,         0),      #;...  %% 'C {AB} D'   [2 2 1 3]   35\n      c(0.7500,    1.2500,   -0.3536), #;...  %% 'C A {BD}'   [2 3 1 3]   36\n      c(-0.7500,    0.7500,   -1.0607),#;...  %% 'C {BD} A'   [3 2 1 2]   37\n      c(0.7500,    0.7500,   -1.0607), #;...  %% 'C {AD} B'   [2 3 1 2]   38\n      c(-0.7500,    1.2500,   -0.3536) #;...  %% 'C B {AD}'   [3 2 1 3]   39\n    )\n    \n    ranksC=rbind(c(4,2,1,3),c(4,3,1,2),c(3,4,1,2),c(2,4,1,3),c(2,3,1,4),c(3,2,1,4),c(2,2,1,2),\n                 c(3,3,1,2),c(2,2,1,3),c(2,3,1,3),c(3,2,1,2),c(2,3,1,2),c(3,2,1,3)             \n    )\n    \n    \n    #--------------------------------------\n    #exagon D first\n    \n    E4=rbind(\n      c(-1.0, -1.0, -0.70710677),# ...    %%'D B C A'     [4 2 3 1]   40\n      c(-0.5, -0.5, -1.4142135),#  ...    %%'D C B A'     [4 3 2 1]   41\n      c(0.5, -0.5, -1.4142135),#   ...    %%'D C A B'     [3 4 2 1]   42\n      c(1.0, -1.0, -0.70710677),#  ...    %%'D A C B'     [2 4 3 1]   43\n      c(0.5, -1.5,  0.0),#         ...    %%'D A B C'     [2 3 4 1]   44\n      c(-0.5, -1.5,  0.0) #        ...    %%'D B A C'     [3 2 4 1]   45\n    )\n    \n    MD=apply(E4,2,mean) #center of exagon D  D(ABC)        [2 2 2 1]  46\n    \n    E4T=rbind(\n      c(0,   -0.5000,   -1.4142),      #;...  %% 'D C {AB}'   [3 3 2 1]   47\n      c(0,   -1.5000,         0),      #;...  %% 'D {AB} C'   [2 2 3 1]   48\n      c(-0.7500,   -1.2500,   -0.3536),#;...  %% 'D B {AC}'   [3 2 3 1]   49\n      c(0.7500,   -0.7500,   -1.0607), #;...  %% 'D {AC} B'   [2 3 2 1]   50\n      c(-0.7500,   -0.7500,   -1.0607),#;...  %% 'D {BC} A'   [3 2 2 1]   51\n      c(0.7500,   -1.2500,   -0.3536)  #;...  %% 'D A {BC}'   [2 3 3 1]   52\n    )\n    \n    ranksD=rbind(c(4,2,3,1),c(4,3,2,1),c(3,4,2,1),c(2,4,3,1),c(2,3,4,1),c(3,2,4,1),c(2,2,2,1),\n                 c(3,3,2,1),c(2,2,3,1),c(3,2,3,1),c(2,3,2,1),c(3,2,2,1),c(2,3,3,1)             \n    )\n    \n    \n    #squares----------------------------------------------------------\n    ESQ=rbind(\n      c(0,    0.5000,    1.4142), #      ; ... %% '{AB} C D'   [1 1 2 3]   53\n      c(0,   -0.5000,    1.4142), #      ; ... %% '{AB} D C'   [1 1 3 2]   54\n      c(-0.5000,         0,   -1.4142), # ;...  %% '{CD} B A'   [3 2 1 1]   55\n      c(0.5000,         0,   -1.4142), #  ;...  %% '{CD} A B'   [2 3 1 1]   56\n      c(1.2500,    0.7500,   -0.3536), #  ;...  %% '{AC} D B'   [1 3 1 2]   57\n      c(0.7500,1.2500,0.3536),       #  ;...  %% '{AC} B D'   [1 2 1 3]   58\n      c(-1.2500,   0.7500,   -0.3536), #  ;...  %% '{BC} D A'   [3 1 1 2]   59\n      c(-0.7500,    1.2500,    0.3536), # ;...  %% '{BC} A D'   [2 1 1 3]   60\n      c(1.2500,   -0.7500,   -0.3536), #  ;...  %% '{AD} C B'   [1 3 2 1]   61\n      c(0.7500,   -1.2500,    0.3536), #  ;...  %% '{AD} B C'   [1 2 3 1]   62\n      c(-1.2500,   -0.7500,   -0.3536), # ;...  %% '{BD} C A'   [3 1 2 1]   63\n      c(-0.7500,   -1.2500,    0.3536) #  ;...  %% '{BD} A C'   [2 1 3 1]   64\n    )\n    \n    ranksSQ=rbind(c(1,1,2,3),c(1,1,3,2),c(3,2,1,1),c(2,3,1,1),c(1,3,1,2),c(1,2,1,3),\n                  c(3,1,1,2),c(2,1,1,3),c(1,3,2,1),c(1,2,3,1),c(3,1,2,1),c(2,1,3,1)\n    )\n    \n    #------------------------------------------------------------------------\n    \n    M_AB_CD=apply(rbind(c(0,0.5,1.4142),c(-0.5,0,1.4142),c(0,-0.5,1.4142),\n                        c(0.5,0,1.4142)),2,mean) # '{AB}{CD}'   [1 1 2 2]   65\n    \n    M_AC_BD=apply(rbind(c(1.25,0.75,0.3536),c(1.25,0.75,-0.3536),c(0.75,1.25,-0.3536),\n                        c(0.75,1.25,0.3536)),2,mean) #'{AC}{BD}'   [1 2 1 2] 66\n    \n    M_BC_AD=apply(rbind(c(-0.75,1.25,-0.3536),c(-1.25,0.75,-0.3536),c(-1.25,0.75,0.3536),\n                        c(-0.75,1.25,0.3536)),2,mean) # '{BC}{AD}'   [2 1 1 2] 67\n    \n    EMID=rbind(M_AB_CD, M_AC_BD, M_BC_AD, M_AB_CD*-1, M_AC_BD*-1, M_BC_AD*-1,MA*-1,MB*-1,MC*-1,MD*-1) \n    #M_AB_CD*-1 = '{CD}{AB}'   [2 2 1 1] 68\n    #M_AC_BD*-1 = '{BD}{AC}'   [2 1 2 1] 69\n    #M_BC_AD*-1;= '{AD}{BC}'   [1 2 2 1] 70\n    #MA*-1;=      '{BCD}A'   [2 1 1 1] 71\n    #MB*-1;=      '{ACD}B'   [1 2 1 1] 72\n    #MC*-1;=      '{ABD}C'   [1 1 2 1] 73\n    #MD*-1;=      '{ABC}D'   [1 1 1 2] 74\n    #last =        {ABCD}    [1 1 1 1] 75 \n    \n    rankres=rbind(c(1,1,2,2),c(1,2,1,2),c(2,1,1,2),c(2,2,1,1),c(2,1,2,1),\n                  c(1,2,2,1),c(2,1,1,1),c(1,2,1,1),c(1,1,2,1),c(1,1,1,2),c(1,1,1,1)\n    )\n    \n    \n    \n    \n    EE=rbind(E1,MA,E1T,E2,MB,E2T,E3,MC,E3T,E4,MD,E4T,ESQ,EMID)\n    coord=rbind(EE,apply(EE,2,mean))\n    ranks=rbind(ranksA,ranksB,ranksC,ranksD,ranksSQ,rankres)\n    \n    if (is.null(L)){\n      rr=labels(ranks,4,labs=2)\n    } else {\n      rr=labels(ranks,4,L,labs=1)\n    }\n    \n    \n    \n    plot3d(coord, type = 'p', xlab = '', ylab = '', zlab = '', add = T, \n           aspect = T, box = F, axes = F, col = 1)\n    \n    #exagon A first\n    segments3d(E1[c(1,2),], lwd=1, col = 1)\n    segments3d(E1[c(2,3),], lwd=1, col = 1)\n    segments3d(E1[c(3,4),], lwd=1, col = 1)\n    segments3d(E1[c(4,5),], lwd=1, col = 1)\n    segments3d(E1[c(5,6),], lwd=1, col = 1)\n    segments3d(E1[c(1,6),], lwd=1, col = 1)\n    segments3d(E1T[c(1,2),], lwd=0.5, col = 'gray')\n    segments3d(E1T[c(3,4),], lwd=0.5, col = 'gray')\n    segments3d(E1T[c(5,6),], lwd=0.5, col = 'gray')\n    #exagon B first\n    segments3d(E2[c(1,2),], lwd=1, col = 1)\n    segments3d(E2[c(2,3),], lwd=1, col = 1)\n    segments3d(E2[c(3,4),], lwd=1, col = 1)\n    segments3d(E2[c(4,5),], lwd=1, col = 1)\n    segments3d(E2[c(5,6),], lwd=1, col = 1)\n    segments3d(E2[c(1,6),], lwd=1, col = 1)\n    segments3d(E2T[c(1,2),], lwd=0.5,col = 'gray')\n    segments3d(E2T[c(3,4),], lwd=0.5,col = 'gray')\n    segments3d(E2T[c(5,6),], lwd=0.5,col = 'gray')\n    #exagon C first\n    segments3d(E3[c(1,2),], lwd=1, col = 1)\n    segments3d(E3[c(2,3),], lwd=1, col = 1)\n    segments3d(E3[c(3,4),], lwd=1, col = 1)\n    segments3d(E3[c(4,5),], lwd=1, col = 1)\n    segments3d(E3[c(5,6),], lwd=1, col = 1)\n    segments3d(E3[c(1,6),], lwd=1, col = 1)\n    segments3d(E3T[c(1,2),], lwd=0.5,col = 'gray')\n    segments3d(E3T[c(3,4),], lwd=0.5,col = 'gray')\n    segments3d(E3T[c(5,6),], lwd=0.5,col = 'gray')\n    #exagon D first\n    segments3d(E4[c(1,2),], lwd=1, col = 1)\n    segments3d(E4[c(2,3),], lwd=1, col = 1)\n    segments3d(E4[c(3,4),], lwd=1, col = 1)\n    segments3d(E4[c(4,5),], lwd=1, col = 1)\n    segments3d(E4[c(5,6),], lwd=1, col = 1)\n    segments3d(E4[c(1,6),], lwd=1, col = 1)\n    segments3d(E4T[c(1,2),], lwd=0.5,col = 'gray')\n    segments3d(E4T[c(3,4),], lwd=0.5,col = 'gray')\n    segments3d(E4T[c(5,6),], lwd=0.5,col = 'gray')\n    #squares\n    segments3d(rbind(E1[1,],E2[4,]), lwd=1, col = 1)\n    segments3d(rbind(E1[6,],E2[5,]), lwd=1, col = 1)\n    segments3d(rbind(E3[2,],E4[2,]), lwd=1, col = 1)\n    segments3d(rbind(E3[3,],E4[3,]), lwd=1, col = 1)\n    segments3d(rbind(E1[5,],E4[5,]), lwd=1, col = 1)\n    segments3d(rbind(E1[4,],E4[4,]), lwd=1, col = 1)\n    segments3d(rbind(E2[1,],E4[1,]), lwd=1, col = 1)\n    segments3d(rbind(E2[6,],E4[6,]), lwd=1, col = 1)\n    segments3d(rbind(E1[2,],E3[5,]), lwd=1, col = 1)\n    segments3d(rbind(E1[3,],E3[4,]), lwd=1, col = 1)\n    segments3d(rbind(E2[2,],E3[1,]), lwd=1, col = 1)\n    segments3d(rbind(E2[3,],E3[6,]), lwd=1, col = 1)\n    #other exagons\n    segments3d(rbind(ESQ[1,],ESQ[2,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[3,],ESQ[4,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[5,],ESQ[6,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[7,],ESQ[8,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[9,],ESQ[10,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[11,],ESQ[12,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E1T[1,],E3T[3,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E2T[3,],E3T[6,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E1T[3,],E2T[1,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E1T[5,],E4T[6,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E2T[5,],E4T[3,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(E3T[1,],E4T[1,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[1,],E3T[2,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[6,],E2T[6,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[8,],E1T[6,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[2,],E4T[2,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[7,],E4T[5,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[5,],E4T[4,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[12,],E1T[2,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[10,],E2T[4,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[4,],E1T[4,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[9,],E3T[5,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[3,],E2T[2,]), lwd=0.5, col = 'gray')\n    segments3d(rbind(ESQ[11,],E3T[4,]), lwd=0.5, col = 'gray')\n    #-----------------------------\n    \n    if (is.null(X)){\n      indplot=matrix(1:75,ncol=1)\n    } else {\n      \n      \n      #ranksinplot=ranks[apply(o, 2, any),]\n      \n      o2 = outer(seq_len(nrow(ranks)), seq_len(nrow(X)), Vectorize(\n        function(i, j) which(all(ranks[i,]==X[j,]))\n      ))\n      \n      indexing=o2==1\n      #print(indexing)\n      indexing[indexing==TRUE]=1\n      indexing[is.na(indexing)]=0\n      indplot=which(rowSums(indexing)==1)\n      #print(indplot)\n      #       ranksinplot=ranks[indplot,]\n      #       \n      #       o = outer(seq_len(nrow(X)), seq_len(nrow(ranksinplot)), Vectorize(\n      #         function(i, j) all(X[i,]==ranksinplot[j,])\n      #       ))\n      #       \n      #       \n      #       \n      #       indexlabs=o==1\n      #       #print(indexing)\n      #       indexlabs[indexlabs==TRUE]=1\n      #       indexlabs[is.na(indexlabs)]=0\n      #       indlab=matrix(nrow=ncol(indexlabs),ncol=1)\n      #       for (j in 1:nrow(indlab)){\n      #         indlab[j,1]=which(indexlabs[j,]==1)\n      #       }\n      \n      \n      \n    }\n    #points(coord[indplot,1],coord[indplot,2],pch=16)\n    #points3d(coord[indplot,],col=\"blue\",cex=sqrt(100*((Wk/sum(Wk))/pi)))\n    \n    if (is.null(Wk)){\n      \n      spheres3d(coord[indplot,],col=\"blue\",radius=0.02)\n      \n    } else {\n      idwk=matrix(0,nrow(X),1)\n      counter=0\n      for (i in 1:75){\n        for (j in 1:nrow(X)){\n          check=sum(pos=X[j,]==ranks[i,])\n          if (check==4){\n            counter=counter+1\n            idwk[counter]=j\n            break}\n        }\n      }\n      \n      spheres3d(coord[indplot,],col=\"blue\",radius=sqrt(((Wk[idwk]/sum(Wk))/(25*pi))))\n      \n    }\n    #text(tcoord[indplot,],rr[indplot,])\n    text3d(coord[indplot,1]+0.1, coord[indplot,2]+0.1, \n           coord[indplot,3]+0.1,rr[indplot,],col=1,cex=0.7)\n  }\n}\n",
    "created" : 1491687813133.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1064855851",
    "id" : "FCD519F6",
    "lastKnownWriteTime" : 1491688225,
    "last_content_update" : 1491688225547,
    "path" : "~/R projects Antonio/ConsRank/R/polyplot.R",
    "project_path" : "R/polyplot.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 15,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}